Training Started!!!!!!!!!!
Namespace(H=1080, O=True, W=1920, bg_radius=-1, bound=1.0, ckpt='latest', clip_text='', color_space='srgb', cuda_ray=True, density_thresh=10, dt_gamma=0.0, error_map=False, ff=False, fovy=50, fp16=True, gui=False, iters=10000, lr=0.01, max_ray_batch=4096, max_spp=64, max_steps=1024, min_near=0.2, num_rays=16384, num_steps=512, offset=[0, 0, 0], patch_size=1, path='../nerf-pytorch/data/nerf_synthetic/lego', preload=True, radius=5, rand_pose=-1, scale=0.8, seed=0, tcnn=False, test=False, update_extra_interval=16, upsample_steps=0, workspace='trial_nerf')
NeRFNetwork(
  (encoder): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 2048 per_level_scale=1.3819 params=(6119864, 2) gridtype=hash align_corners=False interpolation=linear
  (sigma_net): ModuleList(
    (0): Linear(in_features=32, out_features=64, bias=False)
    (1): Linear(in_features=64, out_features=16, bias=False)
  )
  (encoder_dir): SHEncoder: input_dim=3 degree=4
  (color_net): ModuleList(
    (0): Linear(in_features=31, out_features=64, bias=False)
    (1): Linear(in_features=64, out_features=64, bias=False)
    (2): Linear(in_features=64, out_features=3, bias=False)
  )
)
Loading train data: 100%|██████████| 100/100 [00:01<00:00, 58.73it/s]
 ... (more hidden) ...
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /scratch/vb2386/Documents/torch-ngp/venv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
[INFO] Trainer: ngp | 2024-05-10_05-46-29 | cuda | fp16 | trial_nerf
[INFO] #parameters: 12249072
[INFO] Training from scratch ...
[mark untrained grid] 0 from 2097152
==> Start Training Epoch 1, lr=0.010000 ...
==> Finished Epoch 1.
==> Start Training Epoch 2, lr=0.009772 ...
 ... (more hidden) ...
==> Finished Epoch 2.
==> Start Training Epoch 3, lr=0.009550 ...
==> Finished Epoch 3.
==> Start Training Epoch 4, lr=0.009333 ...
 ... (more hidden) ...
==> Finished Epoch 4.
==> Start Training Epoch 5, lr=0.009120 ...
==> Finished Epoch 5.
 ... (more hidden) ...
==> Start Training Epoch 6, lr=0.008913 ...
==> Finished Epoch 6.
==> Start Training Epoch 7, lr=0.008710 ...
 ... (more hidden) ...
==> Finished Epoch 7.
==> Start Training Epoch 8, lr=0.008511 ...
==> Finished Epoch 8.
==> Start Training Epoch 9, lr=0.008318 ...
==> Finished Epoch 9.
 ... (more hidden) ...
==> Start Training Epoch 10, lr=0.008128 ...
==> Finished Epoch 10.
==> Start Training Epoch 11, lr=0.007943 ...
 ... (more hidden) ...
==> Finished Epoch 11.
==> Start Training Epoch 12, lr=0.007762 ...
==> Finished Epoch 12.
==> Start Training Epoch 13, lr=0.007586 ...
 ... (more hidden) ...
==> Finished Epoch 13.
==> Start Training Epoch 14, lr=0.007413 ...
==> Finished Epoch 14.
==> Start Training Epoch 15, lr=0.007244 ...
==> Finished Epoch 15.
==> Start Training Epoch 16, lr=0.007079 ...
 ... (more hidden) ...
==> Finished Epoch 16.
==> Start Training Epoch 17, lr=0.006918 ...
 ... (more hidden) ...
==> Finished Epoch 17.
==> Start Training Epoch 18, lr=0.006761 ...
==> Finished Epoch 18.
==> Start Training Epoch 19, lr=0.006607 ...
==> Finished Epoch 19.
 ... (more hidden) ...
==> Start Training Epoch 20, lr=0.006457 ...
==> Finished Epoch 20.
==> Start Training Epoch 21, lr=0.006310 ...
 ... (more hidden) ...
==> Finished Epoch 21.
==> Start Training Epoch 22, lr=0.006166 ...
==> Finished Epoch 22.
==> Start Training Epoch 23, lr=0.006026 ...
 ... (more hidden) ...
==> Finished Epoch 23.
==> Start Training Epoch 24, lr=0.005888 ...
==> Finished Epoch 24.
==> Start Training Epoch 25, lr=0.005754 ...
 ... (more hidden) ...
==> Finished Epoch 25.
==> Start Training Epoch 26, lr=0.005623 ...
==> Finished Epoch 26.
==> Start Training Epoch 27, lr=0.005495 ...
 ... (more hidden) ...
==> Finished Epoch 27.
==> Start Training Epoch 28, lr=0.005370 ...
==> Finished Epoch 28.
==> Start Training Epoch 29, lr=0.005248 ...
==> Finished Epoch 29.
==> Start Training Epoch 30, lr=0.005129 ...
 ... (more hidden) ...
==> Finished Epoch 30.
==> Start Training Epoch 31, lr=0.005012 ...
==> Finished Epoch 31.
==> Start Training Epoch 32, lr=0.004898 ...
 ... (more hidden) ...
==> Finished Epoch 32.
==> Start Training Epoch 33, lr=0.004786 ...
==> Finished Epoch 33.
==> Start Training Epoch 34, lr=0.004677 ...
 ... (more hidden) ...
==> Finished Epoch 34.
==> Start Training Epoch 35, lr=0.004571 ...
==> Finished Epoch 35.
 ... (more hidden) ...
==> Start Training Epoch 36, lr=0.004467 ...
==> Finished Epoch 36.
==> Start Training Epoch 37, lr=0.004365 ...
 ... (more hidden) ...
==> Finished Epoch 37.
==> Start Training Epoch 38, lr=0.004266 ...
==> Finished Epoch 38.
==> Start Training Epoch 39, lr=0.004169 ...
 ... (more hidden) ...
==> Finished Epoch 39.
==> Start Training Epoch 40, lr=0.004074 ...
==> Finished Epoch 40.
==> Start Training Epoch 41, lr=0.003981 ...
 ... (more hidden) ...
==> Finished Epoch 41.
==> Start Training Epoch 42, lr=0.003890 ...
==> Finished Epoch 42.
==> Start Training Epoch 43, lr=0.003802 ...
 ... (more hidden) ...
==> Finished Epoch 43.
==> Start Training Epoch 44, lr=0.003715 ...
==> Finished Epoch 44.
==> Start Training Epoch 45, lr=0.003631 ...
 ... (more hidden) ...
==> Finished Epoch 45.
==> Start Training Epoch 46, lr=0.003548 ...
==> Finished Epoch 46.
==> Start Training Epoch 47, lr=0.003467 ...
 ... (more hidden) ...
==> Finished Epoch 47.
==> Start Training Epoch 48, lr=0.003388 ...
==> Finished Epoch 48.
==> Start Training Epoch 49, lr=0.003311 ...
 ... (more hidden) ...
==> Finished Epoch 49.
==> Start Training Epoch 50, lr=0.003236 ...
==> Finished Epoch 50.
++> Evaluate at epoch 50 ...
 ... (more hidden) ...
PSNR = 34.208898
LPIPS (alex) = 0.014289
++> Evaluate epoch 50 Finished.
[INFO] New best result: None --> 0.0004233672338887118
==> Start Training Epoch 51, lr=0.003162 ...
==> Finished Epoch 51.
==> Start Training Epoch 52, lr=0.003090 ...
 ... (more hidden) ...
==> Finished Epoch 52.
==> Start Training Epoch 53, lr=0.003020 ...
==> Finished Epoch 53.
==> Start Training Epoch 54, lr=0.002951 ...
 ... (more hidden) ...
==> Finished Epoch 54.
==> Start Training Epoch 55, lr=0.002884 ...
==> Finished Epoch 55.
==> Start Training Epoch 56, lr=0.002818 ...
 ... (more hidden) ...
==> Finished Epoch 56.
==> Start Training Epoch 57, lr=0.002754 ...
==> Finished Epoch 57.
==> Start Training Epoch 58, lr=0.002692 ...
 ... (more hidden) ...
==> Finished Epoch 58.
==> Start Training Epoch 59, lr=0.002630 ...
==> Finished Epoch 59.
==> Start Training Epoch 60, lr=0.002570 ...
 ... (more hidden) ...
==> Finished Epoch 60.
==> Start Training Epoch 61, lr=0.002512 ...
==> Finished Epoch 61.
==> Start Training Epoch 62, lr=0.002455 ...
 ... (more hidden) ...
==> Finished Epoch 62.
==> Start Training Epoch 63, lr=0.002399 ...
==> Finished Epoch 63.
==> Start Training Epoch 64, lr=0.002344 ...
 ... (more hidden) ...
==> Finished Epoch 64.
==> Start Training Epoch 65, lr=0.002291 ...
==> Finished Epoch 65.
==> Start Training Epoch 66, lr=0.002239 ...
==> Finished Epoch 66.
==> Start Training Epoch 67, lr=0.002188 ...
 ... (more hidden) ...
==> Finished Epoch 67.
==> Start Training Epoch 68, lr=0.002138 ...
==> Finished Epoch 68.
==> Start Training Epoch 69, lr=0.002089 ...
 ... (more hidden) ...
==> Finished Epoch 69.
==> Start Training Epoch 70, lr=0.002042 ...
==> Finished Epoch 70.
==> Start Training Epoch 71, lr=0.001995 ...
 ... (more hidden) ...
==> Finished Epoch 71.
==> Start Training Epoch 72, lr=0.001950 ...
==> Finished Epoch 72.
==> Start Training Epoch 73, lr=0.001905 ...
 ... (more hidden) ...
==> Finished Epoch 73.
==> Start Training Epoch 74, lr=0.001862 ...
==> Finished Epoch 74.
==> Start Training Epoch 75, lr=0.001820 ...
 ... (more hidden) ...
==> Finished Epoch 75.
==> Start Training Epoch 76, lr=0.001778 ...
==> Finished Epoch 76.
==> Start Training Epoch 77, lr=0.001738 ...
 ... (more hidden) ...
==> Finished Epoch 77.
==> Start Training Epoch 78, lr=0.001698 ...
==> Finished Epoch 78.
==> Start Training Epoch 79, lr=0.001660 ...
 ... (more hidden) ...
==> Finished Epoch 79.
==> Start Training Epoch 80, lr=0.001622 ...
 ... (more hidden) ...
==> Finished Epoch 80.
==> Start Training Epoch 81, lr=0.001585 ...
 ... (more hidden) ...
==> Finished Epoch 81.
 ... (more hidden) ...
==> Start Training Epoch 82, lr=0.001549 ...
==> Finished Epoch 82.
 ... (more hidden) ...
==> Start Training Epoch 83, lr=0.001514 ...
==> Finished Epoch 83.
 ... (more hidden) ...
==> Start Training Epoch 84, lr=0.001479 ...
==> Finished Epoch 84.
 ... (more hidden) ...
==> Start Training Epoch 85, lr=0.001445 ...
 ... (more hidden) ...
==> Finished Epoch 85.
==> Start Training Epoch 86, lr=0.001413 ...
 ... (more hidden) ...
==> Finished Epoch 86.
==> Start Training Epoch 87, lr=0.001380 ...
 ... (more hidden) ...
==> Finished Epoch 87.
==> Start Training Epoch 88, lr=0.001349 ...
 ... (more hidden) ...
==> Finished Epoch 88.
==> Start Training Epoch 89, lr=0.001318 ...
 ... (more hidden) ...
==> Finished Epoch 89.
==> Start Training Epoch 90, lr=0.001288 ...
 ... (more hidden) ...
==> Finished Epoch 90.
==> Start Training Epoch 91, lr=0.001259 ...
 ... (more hidden) ...
==> Finished Epoch 91.
==> Start Training Epoch 92, lr=0.001230 ...
 ... (more hidden) ...
==> Finished Epoch 92.
==> Start Training Epoch 93, lr=0.001202 ...
 ... (more hidden) ...
==> Finished Epoch 93.
==> Start Training Epoch 94, lr=0.001175 ...
 ... (more hidden) ...
==> Finished Epoch 94.
==> Start Training Epoch 95, lr=0.001148 ...
 ... (more hidden) ...
==> Finished Epoch 95.
==> Start Training Epoch 96, lr=0.001122 ...
 ... (more hidden) ...
==> Finished Epoch 96.
==> Start Training Epoch 97, lr=0.001096 ...
 ... (more hidden) ...
==> Finished Epoch 97.
 ... (more hidden) ...lr=0.001047: : 100% 100/100 [00:01<00:00, 60.87it/s]
 ... (more hidden) ...lr=0.001047: : 100% 100/100 [00:01<00:00, 60.87it/s]
==> Finished Epoch 98.
loss=0.0023 (0.0008), lr=0.001023: : 100% 100/100 [00:01<00:00, 59.98it/s]
loss=0.0023 (0.0008), lr=0.001023: : 100% 100/100 [00:01<00:00, 59.98it/s]
==> Finished Epoch 99.
 ... (more hidden) ...lr=0.001000: : 100% 100/100 [00:01<00:00, 60.57it/s]
 ... (more hidden) ...lr=0.001000: : 100% 100/100 [00:01<00:00, 60.57it/s]
==> Finished Epoch 100.
++> Evaluate at epoch 100 ...
 ... (more hidden) ...lr=0.001000: : 100% 100/100 [00:01<00:00, 60.57it/s]
 ... (more hidden) ...lr=0.001000: : 100% 100/100 [00:01<00:00, 60.57it/s]
 ... (more hidden) ...lr=0.001000: : 100% 100/100 [00:01<00:00, 60.57it/s]
loss=0.0003 (0.0003): : 100% 100/100 [00:09<00:00, 10.03it/s]0, 60.57it/s]
loss=0.0003 (0.0003): : 100% 100/100 [00:09<00:00, 10.03it/s]0, 60.57it/s]
PSNR = 35.095204
LPIPS (alex) = 0.011049
++> Evaluate epoch 100 Finished.
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
++> Evaluate at epoch 100 ...
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:03<00:00, 60.06it/s]7it/s]
loss=0.0004 (0.0005): : 100% 200/200 [00:19<00:00, 10.01it/s]06it/s]7it/s]
loss=0.0004 (0.0005): : 100% 200/200 [00:19<00:00, 10.01it/s]06it/s]7it/s]
PSNR = 33.924621
LPIPS (alex) = 0.013739
++> Evaluate epoch 100 Finished.
==> Start Test, save results to trial_nerf/results
==> Finished Test.