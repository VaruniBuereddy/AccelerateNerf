Training Started!!!!!!!!!!
Namespace(H=1080, O=True, W=1920, bg_radius=-1, bound=1.0, ckpt='latest', clip_text='', color_space='srgb', cuda_ray=True, density_thresh=10, dt_gamma=0.0, error_map=False, ff=False, fovy=50, fp16=True, gui=False, iters=10000, lr=0.0005, max_ray_batch=2048, max_spp=64, max_steps=1024, min_near=0.2, num_rays=16384, num_steps=512, offset=[0, 0, 0], patch_size=1, path='../nerf-pytorch/data/nerf_synthetic/lego', preload=True, radius=5, rand_pose=-1, scale=0.8, seed=0, tcnn=False, test=False, update_extra_interval=16, upsample_steps=0, workspace='trial_nerf')
NeRFNetwork(
  (encoder): GridEncoder: input_dim=3 num_levels=16 level_dim=2 resolution=16 -> 2048 per_level_scale=1.3819 params=(6119864, 2) gridtype=hash align_corners=False interpolation=linear
  (sigma_net): ModuleList(
    (0): Linear(in_features=32, out_features=64, bias=False)
    (1): Linear(in_features=64, out_features=16, bias=False)
  )
  (encoder_dir): SHEncoder: input_dim=3 degree=4
  (color_net): ModuleList(
    (0): Linear(in_features=31, out_features=64, bias=False)
    (1): Linear(in_features=64, out_features=64, bias=False)
    (2): Linear(in_features=64, out_features=3, bias=False)
  )
)
Loading train data: 100%|██████████| 100/100 [00:01<00:00, 58.69it/s]
 ... (more hidden) ...
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /scratch/vb2386/Documents/torch-ngp/venv/lib/python3.8/site-packages/lpips/weights/v0.1/alex.pth
[INFO] Trainer: ngp | 2024-05-10_06-08-15 | cuda | fp16 | trial_nerf
[INFO] #parameters: 12249072
[INFO] Training from scratch ...
 ... (more hidden) ...
[mark untrained grid] 0 from 2097152
==> Start Training Epoch 1, lr=0.000500 ...
 ... (more hidden) ...
==> Finished Epoch 1.
==> Start Training Epoch 2, lr=0.000489 ...
==> Finished Epoch 2.
==> Start Training Epoch 3, lr=0.000477 ...
 ... (more hidden) ...
==> Finished Epoch 3.
==> Start Training Epoch 4, lr=0.000467 ...
==> Finished Epoch 4.
==> Start Training Epoch 5, lr=0.000456 ...
 ... (more hidden) ...
==> Finished Epoch 5.
==> Start Training Epoch 6, lr=0.000446 ...
==> Finished Epoch 6.
==> Start Training Epoch 7, lr=0.000435 ...
 ... (more hidden) ...
==> Finished Epoch 7.
==> Start Training Epoch 8, lr=0.000426 ...
==> Finished Epoch 8.
==> Start Training Epoch 9, lr=0.000416 ...
 ... (more hidden) ...
==> Finished Epoch 9.
==> Start Training Epoch 10, lr=0.000406 ...
==> Finished Epoch 10.
==> Start Training Epoch 11, lr=0.000397 ...
 ... (more hidden) ...
==> Finished Epoch 11.
==> Start Training Epoch 12, lr=0.000388 ...
==> Finished Epoch 12.
==> Start Training Epoch 13, lr=0.000379 ...
==> Finished Epoch 13.
==> Start Training Epoch 14, lr=0.000371 ...
 ... (more hidden) ...
==> Finished Epoch 14.
==> Start Training Epoch 15, lr=0.000362 ...
 ... (more hidden) ...
==> Finished Epoch 15.
==> Start Training Epoch 16, lr=0.000354 ...
==> Finished Epoch 16.
==> Start Training Epoch 17, lr=0.000346 ...
 ... (more hidden) ...
==> Finished Epoch 17.
==> Start Training Epoch 18, lr=0.000338 ...
==> Finished Epoch 18.
==> Start Training Epoch 19, lr=0.000330 ...
==> Finished Epoch 19.
==> Start Training Epoch 20, lr=0.000323 ...
 ... (more hidden) ...
==> Finished Epoch 20.
==> Start Training Epoch 21, lr=0.000315 ...
==> Finished Epoch 21.
 ... (more hidden) ...
==> Start Training Epoch 22, lr=0.000308 ...
==> Finished Epoch 22.
==> Start Training Epoch 23, lr=0.000301 ...
 ... (more hidden) ...
==> Finished Epoch 23.
==> Start Training Epoch 24, lr=0.000294 ...
==> Finished Epoch 24.
==> Start Training Epoch 25, lr=0.000288 ...
==> Finished Epoch 25.
==> Start Training Epoch 26, lr=0.000281 ...
 ... (more hidden) ...
==> Finished Epoch 26.
==> Start Training Epoch 27, lr=0.000275 ...
 ... (more hidden) ...
==> Finished Epoch 27.
==> Start Training Epoch 28, lr=0.000269 ...
==> Finished Epoch 28.
==> Start Training Epoch 29, lr=0.000262 ...
 ... (more hidden) ...
==> Finished Epoch 29.
==> Start Training Epoch 30, lr=0.000256 ...
==> Finished Epoch 30.
==> Start Training Epoch 31, lr=0.000251 ...
==> Finished Epoch 31.
==> Start Training Epoch 32, lr=0.000245 ...
 ... (more hidden) ...
==> Finished Epoch 32.
==> Start Training Epoch 33, lr=0.000239 ...
==> Finished Epoch 33.
 ... (more hidden) ...
==> Start Training Epoch 34, lr=0.000234 ...
==> Finished Epoch 34.
==> Start Training Epoch 35, lr=0.000229 ...
 ... (more hidden) ...
==> Finished Epoch 35.
==> Start Training Epoch 36, lr=0.000223 ...
==> Finished Epoch 36.
==> Start Training Epoch 37, lr=0.000218 ...
 ... (more hidden) ...
==> Finished Epoch 37.
==> Start Training Epoch 38, lr=0.000213 ...
==> Finished Epoch 38.
==> Start Training Epoch 39, lr=0.000208 ...
==> Finished Epoch 39.
==> Start Training Epoch 40, lr=0.000204 ...
 ... (more hidden) ...
==> Finished Epoch 40.
==> Start Training Epoch 41, lr=0.000199 ...
==> Finished Epoch 41.
==> Start Training Epoch 42, lr=0.000195 ...
 ... (more hidden) ...
==> Finished Epoch 42.
==> Start Training Epoch 43, lr=0.000190 ...
==> Finished Epoch 43.
 ... (more hidden) ...
==> Start Training Epoch 44, lr=0.000186 ...
==> Finished Epoch 44.
==> Start Training Epoch 45, lr=0.000182 ...
 ... (more hidden) ...
==> Finished Epoch 45.
==> Start Training Epoch 46, lr=0.000177 ...
==> Finished Epoch 46.
==> Start Training Epoch 47, lr=0.000173 ...
 ... (more hidden) ...
==> Finished Epoch 47.
==> Start Training Epoch 48, lr=0.000169 ...
==> Finished Epoch 48.
==> Start Training Epoch 49, lr=0.000166 ...
 ... (more hidden) ...
==> Finished Epoch 49.
==> Start Training Epoch 50, lr=0.000162 ...
==> Finished Epoch 50.
++> Evaluate at epoch 50 ...
 ... (more hidden) ...
PSNR = 28.784810
LPIPS (alex) = 0.064174
++> Evaluate epoch 50 Finished.
[INFO] New best result: None --> 0.0013696683908347041
==> Start Training Epoch 51, lr=0.000158 ...
==> Finished Epoch 51.
==> Start Training Epoch 52, lr=0.000155 ...
 ... (more hidden) ...
==> Finished Epoch 52.
==> Start Training Epoch 53, lr=0.000151 ...
==> Finished Epoch 53.
==> Start Training Epoch 54, lr=0.000148 ...
 ... (more hidden) ...
==> Finished Epoch 54.
==> Start Training Epoch 55, lr=0.000144 ...
==> Finished Epoch 55.
==> Start Training Epoch 56, lr=0.000141 ...
==> Finished Epoch 56.
==> Start Training Epoch 57, lr=0.000138 ...
 ... (more hidden) ...
==> Finished Epoch 57.
==> Start Training Epoch 58, lr=0.000135 ...
==> Finished Epoch 58.
==> Start Training Epoch 59, lr=0.000132 ...
 ... (more hidden) ...
==> Finished Epoch 59.
==> Start Training Epoch 60, lr=0.000129 ...
==> Finished Epoch 60.
 ... (more hidden) ...
==> Start Training Epoch 61, lr=0.000126 ...
==> Finished Epoch 61.
==> Start Training Epoch 62, lr=0.000123 ...
==> Finished Epoch 62.
 ... (more hidden) ...
==> Start Training Epoch 63, lr=0.000120 ...
==> Finished Epoch 63.
==> Start Training Epoch 64, lr=0.000117 ...
 ... (more hidden) ...
==> Finished Epoch 64.
==> Start Training Epoch 65, lr=0.000115 ...
==> Finished Epoch 65.
==> Start Training Epoch 66, lr=0.000112 ...
 ... (more hidden) ...
==> Finished Epoch 66.
==> Start Training Epoch 67, lr=0.000109 ...
==> Finished Epoch 67.
==> Start Training Epoch 68, lr=0.000107 ...
 ... (more hidden) ...
==> Finished Epoch 68.
==> Start Training Epoch 69, lr=0.000104 ...
==> Finished Epoch 69.
==> Start Training Epoch 70, lr=0.000102 ...
==> Finished Epoch 70.
==> Start Training Epoch 71, lr=0.000100 ...
 ... (more hidden) ...
==> Finished Epoch 71.
==> Start Training Epoch 72, lr=0.000097 ...
==> Finished Epoch 72.
 ... (more hidden) ...
==> Start Training Epoch 73, lr=0.000095 ...
==> Finished Epoch 73.
==> Start Training Epoch 74, lr=0.000093 ...
==> Finished Epoch 74.
 ... (more hidden) ...
==> Start Training Epoch 75, lr=0.000091 ...
==> Finished Epoch 75.
==> Start Training Epoch 76, lr=0.000089 ...
 ... (more hidden) ...
==> Finished Epoch 76.
==> Start Training Epoch 77, lr=0.000087 ...
==> Finished Epoch 77.
==> Start Training Epoch 78, lr=0.000085 ...
 ... (more hidden) ...
==> Finished Epoch 78.
==> Start Training Epoch 79, lr=0.000083 ...
 ... (more hidden) ...
==> Finished Epoch 79.
==> Start Training Epoch 80, lr=0.000081 ...
 ... (more hidden) ...
==> Finished Epoch 80.
==> Start Training Epoch 81, lr=0.000079 ...
 ... (more hidden) ...
==> Finished Epoch 81.
==> Start Training Epoch 82, lr=0.000077 ...
 ... (more hidden) ...
==> Finished Epoch 82.
==> Start Training Epoch 83, lr=0.000076 ...
 ... (more hidden) ...
==> Finished Epoch 83.
==> Start Training Epoch 84, lr=0.000074 ...
 ... (more hidden) ...
==> Finished Epoch 84.
==> Start Training Epoch 85, lr=0.000072 ...
 ... (more hidden) ...
==> Finished Epoch 85.
==> Start Training Epoch 86, lr=0.000071 ...
 ... (more hidden) ...
==> Finished Epoch 86.
==> Start Training Epoch 87, lr=0.000069 ...
 ... (more hidden) ...
==> Finished Epoch 87.
==> Start Training Epoch 88, lr=0.000067 ...
 ... (more hidden) ...
==> Finished Epoch 88.
==> Start Training Epoch 89, lr=0.000066 ...
 ... (more hidden) ...
==> Finished Epoch 89.
==> Start Training Epoch 90, lr=0.000064 ...
==> Finished Epoch 90.
==> Start Training Epoch 91, lr=0.000063 ...
 ... (more hidden) ...
==> Finished Epoch 91.
==> Start Training Epoch 92, lr=0.000062 ...
 ... (more hidden) ...
==> Finished Epoch 92.
==> Start Training Epoch 93, lr=0.000060 ...
 ... (more hidden) ...
==> Finished Epoch 93.
 ... (more hidden) ...
==> Start Training Epoch 94, lr=0.000059 ...
==> Finished Epoch 94.
 ... (more hidden) ...
==> Start Training Epoch 95, lr=0.000057 ...
==> Finished Epoch 95.
 ... (more hidden) ...
==> Start Training Epoch 96, lr=0.000056 ...
 ... (more hidden) ...
==> Finished Epoch 96.
==> Start Training Epoch 97, lr=0.000055 ...
 ... (more hidden) ...
==> Finished Epoch 97.
 ... (more hidden) ...lr=0.000052: : 100% 100/100 [00:01<00:00, 57.60it/s]
 ... (more hidden) ...lr=0.000052: : 100% 100/100 [00:01<00:00, 57.60it/s]
==> Finished Epoch 98.
loss=0.0018 (0.0011), lr=0.000051: : 100% 100/100 [00:01<00:00, 57.19it/s]
loss=0.0018 (0.0011), lr=0.000051: : 100% 100/100 [00:01<00:00, 57.19it/s]
==> Finished Epoch 99.
 ... (more hidden) ...lr=0.000050: : 100% 100/100 [00:01<00:00, 57.87it/s]
 ... (more hidden) ...lr=0.000050: : 100% 100/100 [00:01<00:00, 57.87it/s]
==> Finished Epoch 100.
++> Evaluate at epoch 100 ...
 ... (more hidden) ...lr=0.000050: : 100% 100/100 [00:01<00:00, 57.87it/s]
 ... (more hidden) ...lr=0.000050: : 100% 100/100 [00:01<00:00, 57.87it/s]
 ... (more hidden) ...lr=0.000050: : 100% 100/100 [00:01<00:00, 57.87it/s]
 ... (more hidden) ...lr=0.000050: : 100% 100/100 [00:01<00:00, 57.87it/s]
 ... (more hidden) ...lr=0.000050: : 100% 100/100 [00:01<00:00, 57.87it/s]
loss=0.0007 (0.0010): : 100% 100/100 [00:13<00:00,  7.25it/s]0, 57.87it/s]
loss=0.0007 (0.0010): : 100% 100/100 [00:13<00:00,  7.25it/s]0, 57.87it/s]
PSNR = 30.386569
LPIPS (alex) = 0.040395
++> Evaluate epoch 100 Finished.
Loading test data: 100%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
++> Evaluate at epoch 100 ...
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
 ... (more hidden) ...%|██████████| 200/200 [00:08<00:00, 23.11it/s]7it/s]
loss=0.0007 (0.0012): : 100% 200/200 [00:28<00:00,  7.13it/s]11it/s]7it/s]
loss=0.0007 (0.0012): : 100% 200/200 [00:28<00:00,  7.13it/s]11it/s]7it/s]
PSNR = 29.447518
LPIPS (alex) = 0.045509
++> Evaluate epoch 100 Finished.
==> Start Test, save results to trial_nerf/results
==> Finished Test.